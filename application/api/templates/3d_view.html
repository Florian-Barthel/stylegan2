<!DOCTYPE html>
<html lang="englisch">
<head>
    <title>Car Factory</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        var image_cache = []
        var global_cache_size = 0
        //var address = "http://127.0.0.1:5000"
        var address = "http://mmc-cuda04.informatik.uni-augsburg.de:5000"
        //var address = "http://gimpel.informatik.uni-augsburg.de:5000"

        window.onload = () => {
            $('#sendbutton').click(() => {
                imagebox = $('#imagebox_rotation')
                seed_textbox = $('#seed')

                manufacturer = document.getElementById("manufacturer").value
                model = document.getElementById("model").value
                color = document.getElementById("color").value
                body = document.getElementById("body").value
                ratio = document.getElementById("ratio").value
                background = document.getElementById("background").value
                randomize_seed = $('#randomize_seed').is(':checked')
                seed = document.getElementById("seed").value
                sendData = {
                    "manufacturer": manufacturer,
                    "model": model,
                    "color": color,
                    "body": body,
                    "background": background,
                    "ratio": ratio,
                    "seed": seed,
                    "randomize_seed": randomize_seed,
                    "size": 700
                }
                $.ajax({
                    url: address + "/load_3d_view",
                    type: "POST",
                    data: JSON.stringify({"payload": sendData}),
                    contentType: 'application/json',
                    error: function (data, textStatus, errorThrown) {
                        console.log("upload error", data);
                        console.log("status", textStatus)
                        console.log("errorThrown", errorThrown)
                        console.log(data.getAllResponseHeaders());
                    },
                    success: function (data) {
                        bytestring = data['status']
                        cache_size = data['cache_size']
                        updateCache(bytestring, cache_size)
                        updateSlider(0)
                        seed_textbox.val(data['seed'])
                    }
                });
            });
        };

        function updateSlider(magnitude) {
            imagebox = $('#imagebox_rotation')
            index = parseInt((magnitude / 100) * (global_cache_size - 1))
            image = image_cache[index]
            if(image !== undefined) {
                imagebox.attr('src', 'data:image/jpeg;base64,' + image_cache[index].split('\'')[1])
            }
        }

        function updateCache(bytestring, cache_size) {
            image_cache = bytestring
            global_cache_size = cache_size
        }
    </script>
</head>
<body>
<div id="header">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="">Car Factory</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="/">Generate</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/interpolate">Interpolate</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="/3d_view">360 View <span
                            class="sr-only">(current)</span></a>
                </li>
            </ul>
        </div>
    </nav>
</div>

<div class="box" style="margin-left:20px;">
    <table style="float:left; margin-right: 50px; margin-bottom: 50px">
        <tr>
            <td>Manufacturer</td>
            <td>
                <form>
                    <label>
                        <select id="manufacturer">
                            <option value="-1">any</option>
                            <option value="0">audi</option>
                            <option value="1">bmw</option>
                            <option value="2">cadillac</option>
                            <option value="3">dacia</option>
                            <option value="4">dodge</option>
                            <option value="5">ferrari</option>
                            <option value="6">fiat</option>
                            <option value="7">goggomobil</option>
                            <option value="8">honda</option>
                            <option value="9">hyundai</option>
                            <option value="10">lada</option>
                            <option value="11">mazda</option>
                            <option value="12">mercedes</option>
                            <option value="13">opel</option>
                            <option value="14">porsche</option>
                            <option value="15">subaru</option>
                            <option value="16">tata</option>
                            <option value="17">vw</option>
                        </select>
                    </label>
                </form>
            </td>
        </tr>
        <tr>
            <td>Model</td>
            <td>
                <form>
                    <label>
                        <select id="model">
                            <option value="-1">any</option>
                            <option value="0">audi a1</option>
                            <option value="1">audi a3</option>
                            <option value="2">audi a4</option>
                            <option value="3">audi a5</option>
                            <option value="4">audi a6</option>
                            <option value="5">audi a7</option>
                            <option value="6">audi a8</option>
                            <option value="7">bmw 1 series</option>
                            <option value="8">bmw 2 series</option>
                            <option value="9">bmw 3 series</option>
                            <option value="10">bmw 4 series</option>
                            <option value="11">bmw 5 series</option>
                            <option value="12">bmw 6 series</option>
                            <option value="13">bmw 7 series</option>
                            <option value="14">bmw i3</option>
                            <option value="15">bmw i8</option>
                            <option value="16">cadillac escalade</option>
                            <option value="17">dacia duster</option>
                            <option value="18">dacia logan</option>
                            <option value="19">dacia sandero</option>
                            <option value="20">dodge challenger srt</option>
                            <option value="21">dodge charger srt</option>
                            <option value="22">dodge ram</option>
                            <option value="23">ferrari california</option>
                            <option value="24">ferrari enzo</option>
                            <option value="25">ferrari la ferrari</option>
                            <option value="26">fiat cinquecento</option>
                            <option value="27">fiat multipla</option>
                            <option value="28">fiat panda</option>
                            <option value="29">fiat spider</option>
                            <option value="30">goggomobil ts250</option>
                            <option value="31">honda civic</option>
                            <option value="32">honda jazz</option>
                            <option value="33">honda nsx</option>
                            <option value="34">hyundai tucson</option>
                            <option value="35">lada niva</option>
                            <option value="36">mazda 3</option>
                            <option value="37">mazda cx5</option>
                            <option value="38">mazda miata</option>
                            <option value="39">mazda rx8</option>
                            <option value="40">mazda5</option>
                            <option value="41">mercedes a-class</option>
                            <option value="42">mercedes b-class</option>
                            <option value="43">mercedes c-class</option>
                            <option value="44">mercedes e-class</option>
                            <option value="45">mercedes g-class</option>
                            <option value="46">mercedes m-class</option>
                            <option value="47">mercedes s-class</option>
                            <option value="48">mercedes sls amg</option>
                            <option value="49">opel adam</option>
                            <option value="50">opel admiral</option>
                            <option value="51">opel astra</option>
                            <option value="52">opel corsa</option>
                            <option value="53">opel grandland x</option>
                            <option value="54">opel insignia</option>
                            <option value="55">opel combo</option>
                            <option value="56">porsche 911 gt3</option>
                            <option value="57">porsche 944</option>
                            <option value="58">porsche cayenne</option>
                            <option value="59">porsche panamera</option>
                            <option value="60">subaru impreza</option>
                            <option value="61">tata nano</option>
                            <option value="62">vw golf 7</option>
                            <option value="63">vw jetta</option>
                            <option value="64">vw passat</option>
                            <option value="65">vw tiguan</option>
                            <option value="66">vw tuareg</option>
                        </select>
                    </label>
                </form>
            </td>
        </tr>
        <tr>
            <td>Color</td>
            <td>
                <form>
                    <label>
                        <select id="color">
                            <option value="-1">any</option>
                            <option value="0">white</option>
                            <option value="1">silver</option>
                            <option value="2">gray</option>
                            <option value="3">black</option>
                            <option value="4">blue</option>
                            <option value="5">red</option>
                            <option value="6">brown</option>
                            <option value="7">green</option>
                            <option value="8">yellow</option>
                            <option value="9">orange</option>
                            <option value="10">purple</option>
                            <option value="11">undefined</option>
                        </select>
                    </label>
                </form>
            </td>
        </tr>
        <tr>
            <td>Body</td>
            <td>
                <form>
                    <label>
                        <select id="body">
                            <option value="-1">any</option>
                            <option value="0">Cabrio</option>
                            <option value="1">Coup√©</option>
                            <option value="2">Hatchback</option>
                            <option value="3">Limousine</option>
                            <option value="4">Off-Road</option>
                            <option value="5">Pickup Truck</option>
                            <option value="6">Sports Car</option>
                            <option value="7">Station Wagon</option>
                            <option value="8">SUV</option>
                            <option value="9">Van</option>
                        </select>
                    </label>
                </form>
            </td>
        </tr>
        <tr>
            <td>Background</td>
            <td>
                <form>
                    <label>
                        <select id="background">
                            <option value="-1">any</option>
                            <option value="0">black</option>
                            <option value="1">city</option>
                            <option value="2">countryside</option>
                            <option value="3">off-road</option>
                            <option value="4">showroom</option>
                            <option value="5">white</option>
                        </select>
                    </label>
                </form>
            </td>
        </tr>
        <tr>
            <td>
                Ratio
            </td>
            <td>
                <form>
                    <label>
                        <select id="ratio">
                            <option value="0">1.2</option>
                            <option value="1" selected="selected">1.4</option>
                            <option value="2">1.6</option>
                            <option value="3">1.8</option>
                            <option value="4">2.0</option>
                        </select>
                    </label>
                </form>
            </td>
        </tr>
        <tr>
            <td>Seed
            </td>
            <td>
                <form>
                    <label for="seed"></label>
                    <input class="attribute" type="text" id="seed" name="seed" value="0">
                </form>
            </td>
        </tr>
        <tr>
            <td>Randomize Seed
            </td>
            <td>
                <form>
                    <label for="randomize_seed"></label>
                    <input type="checkbox" id="randomize_seed" name="randomize_seed" checked>
                </form>
            </td>
        </tr>
        <tr>
            <td></td>
            <td>
                <br>
                <button name="send" id="sendbutton">Generate</button>
            </td>
        </tr>
    </table>

</div>


<div class="box" style="margin-left:20px; margin-top: 20px; margin-bottom: 20px;">
    <label for="rotation_slider">Rotation</label><input id="rotation_slider" class="slider" type="range"
                                                                            min="0" max="100" step="1" value="50"
                                                                            oninput="updateSlider(this.value)">
    <br>
    <img style="margin-top: 20px" id="imagebox_rotation" alt="" src="">
</div>

</body>
</html>

<style>
    select {
        width: 170px;
    }

    .attribute {
        width: 170px;
        padding: 0;
        margin: 0;
        position: absolute;
    }

    label {
        padding: 0;
        margin: 0;
    }

    #randomize_seed {
        margin-top: 5px;
    }

    #randomize_seed_left {
        margin-top: 5px;
    }

    td {
        padding-right: 20px;
    }

    #rotation_slider {
        margin: 20px;
        width: 500px;
    }

    .slider {
        -webkit-appearance: none;
        width: 300px;
        height: 15px;
        border-radius: 5px;
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
    }

    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background: #4c79af;
        cursor: pointer;
    }

    .slider::-moz-range-thumb {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background: #7bb6fc;
        cursor: pointer;
    }

</style>
